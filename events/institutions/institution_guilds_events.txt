namespace = hex_institution_guilds_events

country_event = {
	id = hex_institution_guilds_events.1
	title = hex_institution_guilds_events.1.t
	desc = hex_institution_guilds_events.1.d
	
	picture = HEX_EVENT_PICTURE_FIRST_AWAKE

	fire_only_once = yes
	is_triggered_only = yes

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		FROM = {
			save_event_target_as = institution_origin
		}
	}

	goto = institution_origin

	option = {
		name = hex_institution_guilds_events.1.a
		custom_tooltip = hex_institution_guilds_events.1.a.tt

		highlight = yes

		hidden_effect = {
			country_event = { id = hex_institution_guilds_events.2 }
		}
	}

	option = {
		name = hex_institution_guilds_events.1.b
		custom_tooltip = hex_institution_guilds_events.1.b.tt
	}

	after = {
		hidden_effect = {
			set_global_flag = hex_basis_arc_flag
			FROM = {
				add_permanent_province_modifier = {
					name = hex_birthplace_of_guilds_institution
					duration = -1
				}
			}
	
			hex_inner_city_area = {
				limit = { NOT = { owned_by = ROOT } }
				hex_add_core = yes
			}

			hex_inner_city_area = {
				limit = { NOT = { has_construction = any } }
				add_building_construction = {
					building = hex_building_city_district
					speed = 1
					cost = 0
				}
			}
	
			add_government_reform = hex_city_grand_construction_reform

			country_event = { id = hex_institution_guilds_events.3 days = 10 }
		}
	}
}

country_event = {
	id = hex_institution_guilds_events.2
	title = hex_institution_guilds_events.2.t
	desc = hex_institution_guilds_events.2.d
	
	picture = HEX_EVENT_PICTURE_FIRST_AWAKE

	fire_only_once = yes
	is_triggered_only = yes

	goto = institution_origin

	option = {
		name = hex_institution_guilds_events.2.a
		
		hidden_effect = {
			add_ruler_personality = hex_basis_guild_founder_personality
		}
	}
}

country_event = {
	id = hex_institution_guilds_events.3
	title = hex_institution_guilds_events.3.t
	desc = hex_institution_guilds_events.3.d
	
	picture = HEX_EVENT_PICTURE_EMPTY

	fire_only_once = yes
	is_triggered_only = yes

	trigger = { 
		OR = {
			hex_is_basis_arc = yes
			hex_is_control_arc = yes
		}
	}

	option = {
		name = hex_institution_guilds_events.3.artisan
		
		hidden_effect = {
			set_country_flag = hex_joined_artisan_guild

			add_ruler_personality = hex_basis_artisan_guild_member_personality
		}
	}

	option = {
		name = hex_institution_guilds_events.3.builders
		
		hidden_effect = {
			set_country_flag = hex_joined_builders_guild

			add_ruler_personality = hex_basis_builders_guild_member_personality
		}
	}

	option = {
		name = hex_institution_guilds_events.3.farmers
		
		hidden_effect = {
			set_country_flag = hex_joined_farmers_guild

			add_ruler_personality = hex_basis_farmers_guild_member_personality
		}
	}

	option = {
		name = hex_institution_guilds_events.3.hunters
		
		hidden_effect = {
			set_country_flag = hex_joined_hunters_guild

			add_ruler_personality = hex_basis_hunters_guild_member_personality
		}
	}

	option = {
		name = hex_institution_guilds_events.3.miners
		
		hidden_effect = {
			set_country_flag = hex_joined_miners_guild

			add_ruler_personality = hex_basis_miners_guild_member_personality 
		}
	}

	option = {
		name = hex_institution_guilds_events.3.sailors
		
		hidden_effect = {
			set_country_flag = hex_joined_sailors_guild

			add_ruler_personality = hex_basis_sailors_guild_member_personality
		}
	}

	option = {
		name = hex_institution_guilds_events.3.guildless

		trigger = {
			NOT = { ruler_has_personality = hex_basis_guild_founder_personality }
		}

		hidden_effect = {
			add_ruler_personality = hex_basis_guildless_personality
		}
	}
}